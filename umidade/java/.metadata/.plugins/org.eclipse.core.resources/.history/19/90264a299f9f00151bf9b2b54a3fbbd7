package br.edu.ifba.se.babycare.contexto;

import javax.servlet.ServletContext;
import javax.servlet.ServletContextEvent;

import br.edu.ifba.se.babycare.conector.SingleConector;
import br.edu.ifba.se.babycare.leitor.LeitorAssincrono;

import com.sun.faces.config.ConfigureListener;

public class ConfiguradorContexto extends ConfigureListener {
	

	private LeitorAssincrono leitor;
	private Thread tLeiror;
	

	@Override
	public void contextInitialized(ServletContextEvent sce){
		super.contextInitialized(sce);
		
		ServletContext sc = sce.getServletContext();
		String libPath = sc.getRealPath("/WEB-INF/lib");
		
		SingleConector.iniciarComunicacaoRF(libPath);
		
		
		  leitor = new LeitorAssincrono();
		  tLeitor = new Thread(Leitor);
		  tLeitor.start();
		 
		
	}
	

	  	public void contextDestroyed(ServletContextEvent sce){
	 	leitor.parar();
	   	try{
	   	tLeitor.join();
		} catch(InterruptedException e){
		SingleConector.finalizar();
		}
		super.contextDestroyed(sce);
	}
	 
}
